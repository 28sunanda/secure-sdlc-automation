# Gitleaks Configuration
# Custom rules and allowlists for secret detection

title = "Gitleaks Configuration"

[extend]
# Use default gitleaks rules as base
useDefault = true

# Allowlist - paths and patterns to ignore
[allowlist]
description = "Global allowlist"
paths = [
    '''node_modules''',
    '''\.git''',
    '''vendor''',
    '''__pycache__''',
    '''\.pytest_cache''',
    '''\.venv''',
    '''venv''',
    '''\.env\.example''',
    '''\.env\.sample''',
    '''tests/fixtures''',
    '''docs/examples''',
]

# Regex patterns to ignore (test data, examples)
regexes = [
    '''EXAMPLE_''',
    '''test_''',
    '''fake_''',
    '''dummy_''',
    '''placeholder''',
]

# Custom rules for organization-specific secrets
[[rules]]
id = "custom-api-key"
description = "Custom API Key Pattern"
regex = '''(?i)(company|internal|corp)[-_]?api[-_]?key\s*[=:]\s*['"]?([a-zA-Z0-9_-]{20,})['"]?'''
secretGroup = 2
entropy = 3.5
keywords = ["api", "key"]

[[rules]]
id = "internal-token"
description = "Internal Service Token"
regex = '''(?i)internal[-_]?token\s*[=:]\s*['"]?([a-zA-Z0-9_-]{32,})['"]?'''
secretGroup = 1
entropy = 4.0
keywords = ["token", "internal"]

[[rules]]
id = "database-connection-string"
description = "Database Connection String with Password"
regex = '''(?i)(postgres|mysql|mongodb|redis):\/\/[^:]+:([^@]+)@'''
secretGroup = 2
keywords = ["postgres", "mysql", "mongodb", "redis"]

# Rule-specific allowlists
[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)api[_-]?key\s*[=:]\s*['"]?([a-zA-Z0-9_-]{16,})['"]?'''
secretGroup = 1
entropy = 3.0
keywords = ["api", "key"]

[rules.allowlist]
regexes = [
    '''api_key\s*=\s*os\.environ''',
    '''api_key\s*=\s*config\.get''',
    '''API_KEY_PLACEHOLDER''',
]
